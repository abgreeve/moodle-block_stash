{"version":3,"file":"drop-snippet-ui.min.js","sources":["../src/drop-snippet-ui.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Drop snippet UI module.\n *\n * @copyright  2016 Frédéric Massart - FMCorz.net\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine([\n    'jquery',\n], function($) {\n\n    /**\n     * Snippet UI class.\n     *\n     * @param {DropSnippetMaker} maker The snippet maker.\n     * @param {Node} container The container of the UI.\n     */\n    function UI(maker, container) {\n        this._container = $(container);\n        this._maker = maker;\n        this._init();\n    }\n\n    UI.prototype._container = null;\n    UI.prototype._appearanceNode = null;\n    UI.prototype._labelNode = null;\n    UI.prototype._actionTextNode = null;\n    UI.prototype._previewNode = null;\n    UI.prototype._actionTextNode = null;\n    UI.prototype._snippetNode = null;\n\n    UI.prototype._actionTextZoneNode = null;\n    UI.prototype._labelZoneNode = null;\n\n    /**\n     * Initialise the things.\n     *\n     * @return {Void}\n     */\n    UI.prototype._init = function() {\n        this._appearanceNode = this.find('[name=displaytype]');\n        this._labelNode = this.find('[name=label]');\n        this._actionTextNode = this.find('[name=actiontext]');\n        this._snippetNode = this.find('[name=\"snippet\"]');\n        this._previewNode = this.find('.preview');\n\n        this._labelZoneNode = this.find('.snippet-label');\n        this._actionTextZoneNode = this.find('.snippet-actiontext');\n\n        // Set placeholders.\n        this._labelNode.attr('placeholder', this._maker.getDefaultLabel());\n        this._actionTextNode.attr('placeholder', this._maker.getDefaultActionText());\n\n        // Set form values.\n        this._maker.setLabel(this._labelNode.val());\n        this._maker.setDisplayType(this._appearanceNode.val());\n        this._maker.setActionText(this._actionTextNode.val());\n\n        this._updateForm();\n        this._setListeners();\n        this.update();\n    };\n\n    /**\n     * Find a node in this UI.\n     *\n     * @param {String} selector The selector.\n     * @return {Node}\n     */\n    UI.prototype.find = function(selector) {\n        return this._container.find(selector);\n    };\n\n    /**\n     * Set the event listeners.\n     *\n     * @return {Void}\n     */\n    UI.prototype._setListeners = function() {\n        this._appearanceNode.change(function(e) {\n            this._maker.setDisplayType($(e.currentTarget).val());\n            this._updateForm();\n            this.update();\n        }.bind(this));\n\n        this._labelNode.on('keyup', function(e) {\n            this._maker.setLabel($(e.currentTarget).val());\n            this._updateForm();\n            this.update();\n        }.bind(this));\n\n        this._actionTextNode.on('keyup', function(e) {\n            this._maker.setActionText($(e.currentTarget).val());\n            this._updateForm();\n            this.update();\n        }.bind(this));\n    };\n\n    /**\n     * Update the snippet and preview.\n     *\n     * @return {Void}\n     */\n    UI.prototype.update = function() {\n        var display = this._maker.getDisplay();\n\n        display.find('a, input').click(function(e) { e.preventDefault(); return; });\n\n        this._snippetNode.val(this._maker.getSnippet());\n        this._previewNode.html(display);\n    };\n\n    /**\n     * Update the form.\n     *\n     * @return {Void}\n     */\n    UI.prototype._updateForm = function() {\n        var appearance = this._appearanceNode.val();\n\n        if (appearance == this._maker.IMAGEANDBUTTON) {\n            this._labelZoneNode.hide();\n            this._actionTextZoneNode.show();\n\n        } else if (appearance == this._maker.TEXT) {\n            this._labelZoneNode.show();\n            this._actionTextZoneNode.hide();\n\n        } else {\n            this._labelZoneNode.hide();\n            this._actionTextZoneNode.hide();\n        }\n    };\n\n    return /** @alias module:block_stash/drop-snippet-ui */ UI;\n\n});\n"],"names":["define","$","UI","maker","container","this","_container","_maker","_init","prototype","_appearanceNode","_labelNode","_actionTextNode","_previewNode","_snippetNode","_actionTextZoneNode","_labelZoneNode","find","attr","getDefaultLabel","getDefaultActionText","setLabel","val","setDisplayType","setActionText","_updateForm","_setListeners","update","selector","change","e","currentTarget","bind","on","display","getDisplay","click","preventDefault","getSnippet","html","appearance","IMAGEANDBUTTON","hide","show","TEXT"],"mappings":";;;;;;AAsBAA,qCAAO,CACH,UACD,SAASC,GAQR,SAASC,GAAGC,MAAOC,WACfC,KAAKC,WAAaL,EAAEG,WACpBC,KAAKE,OAASJ,MACdE,KAAKG,QAkHT,OA/GAN,GAAGO,UAAUH,WAAa,KAC1BJ,GAAGO,UAAUC,gBAAkB,KAC/BR,GAAGO,UAAUE,WAAa,KAC1BT,GAAGO,UAAUG,gBAAkB,KAC/BV,GAAGO,UAAUI,aAAe,KAC5BX,GAAGO,UAAUG,gBAAkB,KAC/BV,GAAGO,UAAUK,aAAe,KAE5BZ,GAAGO,UAAUM,oBAAsB,KACnCb,GAAGO,UAAUO,eAAiB,KAO9Bd,GAAGO,UAAUD,MAAQ,WACjBH,KAAKK,gBAAkBL,KAAKY,KAAK,sBACjCZ,KAAKM,WAAaN,KAAKY,KAAK,gBAC5BZ,KAAKO,gBAAkBP,KAAKY,KAAK,qBACjCZ,KAAKS,aAAeT,KAAKY,KAAK,oBAC9BZ,KAAKQ,aAAeR,KAAKY,KAAK,YAE9BZ,KAAKW,eAAiBX,KAAKY,KAAK,kBAChCZ,KAAKU,oBAAsBV,KAAKY,KAAK,uBAGrCZ,KAAKM,WAAWO,KAAK,cAAeb,KAAKE,OAAOY,mBAChDd,KAAKO,gBAAgBM,KAAK,cAAeb,KAAKE,OAAOa,wBAGrDf,KAAKE,OAAOc,SAAShB,KAAKM,WAAWW,OACrCjB,KAAKE,OAAOgB,eAAelB,KAAKK,gBAAgBY,OAChDjB,KAAKE,OAAOiB,cAAcnB,KAAKO,gBAAgBU,OAE/CjB,KAAKoB,cACLpB,KAAKqB,gBACLrB,KAAKsB,UASTzB,GAAGO,UAAUQ,KAAO,SAASW,UACzB,OAAOvB,KAAKC,WAAWW,KAAKW,WAQhC1B,GAAGO,UAAUiB,cAAgB,WACzBrB,KAAKK,gBAAgBmB,OAAO,SAASC,GACjCzB,KAAKE,OAAOgB,eAAetB,EAAE6B,EAAEC,eAAeT,OAC9CjB,KAAKoB,cACLpB,KAAKsB,UACPK,KAAK3B,OAEPA,KAAKM,WAAWsB,GAAG,QAAS,SAASH,GACjCzB,KAAKE,OAAOc,SAASpB,EAAE6B,EAAEC,eAAeT,OACxCjB,KAAKoB,cACLpB,KAAKsB,UACPK,KAAK3B,OAEPA,KAAKO,gBAAgBqB,GAAG,QAAS,SAASH,GACtCzB,KAAKE,OAAOiB,cAAcvB,EAAE6B,EAAEC,eAAeT,OAC7CjB,KAAKoB,cACLpB,KAAKsB,UACPK,KAAK3B,QAQXH,GAAGO,UAAUkB,OAAS,WAClB,IAAIO,QAAU7B,KAAKE,OAAO4B,aAE1BD,QAAQjB,KAAK,YAAYmB,MAAM,SAASN,GAAKA,EAAEO,mBAE/ChC,KAAKS,aAAaQ,IAAIjB,KAAKE,OAAO+B,cAClCjC,KAAKQ,aAAa0B,KAAKL,UAQ3BhC,GAAGO,UAAUgB,YAAc,WACvB,IAAIe,WAAanC,KAAKK,gBAAgBY,MAElCkB,YAAcnC,KAAKE,OAAOkC,gBAC1BpC,KAAKW,eAAe0B,OACpBrC,KAAKU,oBAAoB4B,QAElBH,YAAcnC,KAAKE,OAAOqC,MACjCvC,KAAKW,eAAe2B,OACpBtC,KAAKU,oBAAoB2B,SAGzBrC,KAAKW,eAAe0B,OACpBrC,KAAKU,oBAAoB2B,SAIuBxC,EAE5D"}