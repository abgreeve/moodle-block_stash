{"version":3,"file":"trade-selector.min.js","sources":["../src/trade-selector.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Add items to a trade table.\n *\n * @copyright 2023 Adrian Greeve <adriangreeve.com>\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Dialogue from 'block_stash/trade-item-dialogue';\nimport Counselor from 'block_stash/counselor';\n\nexport const init = () => {\n    registerActions();\n    let warnings = '';\n    let courseelement = document.querySelector('input[name=\"courseid\"]');\n    let courseid = courseelement.value;\n    let title = document.querySelector('.additem[data-type=\"gain\"]').getAttribute('title');\n\n    let additemelements = document.getElementsByClassName('additem');\n    for (let additem of additemelements) {\n        additem.addEventListener('click', (e) => {\n            let node = e.currentTarget;\n            let dialogue = new Dialogue(courseid, node.dataset.type, title, warnings);\n            e.preventDefault();\n            dialogue.show(e);\n            Counselor.on('item-save', () => {\n                dialogue.close();\n                registerActions();\n            });\n        });\n    }\n};\n\nconst registerActions = () => {\n    let deleteelements = document.getElementsByClassName('block-stash-delete-item');\n    for (let delement of deleteelements) {\n        delement.addEventListener('click', deleteItem);\n    }\n};\n\nconst deleteItem = (element) => {\n    let child = element.currentTarget;\n    let parent = child.closest('.block-stash-trade-item');\n    parent.remove();\n    element.preventDefault();\n};\n"],"names":["registerActions","courseid","document","querySelector","value","title","getAttribute","additemelements","getElementsByClassName","additem","addEventListener","e","node","currentTarget","dialogue","Dialogue","dataset","type","preventDefault","show","on","close","deleteelements","delement","deleteItem","element","closest","remove"],"mappings":";;;;;;4MAyBoB,KAChBA,sBAGIC,SADgBC,SAASC,cAAc,0BACdC,MACzBC,MAAQH,SAASC,cAAc,8BAA8BG,aAAa,SAE1EC,gBAAkBL,SAASM,uBAAuB,eACjD,IAAIC,WAAWF,gBAChBE,QAAQC,iBAAiB,SAAUC,QAC3BC,KAAOD,EAAEE,cACTC,SAAW,IAAIC,2BAASd,SAAUW,KAAKI,QAAQC,KAAMZ,MATlD,IAUPM,EAAEO,iBACFJ,SAASK,KAAKR,sBACJS,GAAG,aAAa,KACtBN,SAASO,QACTrB,+BAMVA,gBAAkB,SAChBsB,eAAiBpB,SAASM,uBAAuB,+BAChD,IAAIe,YAAYD,eACjBC,SAASb,iBAAiB,QAASc,aAIrCA,WAAcC,UACJA,QAAQZ,cACDa,QAAQ,2BACpBC,SACPF,QAAQP"}